import{j as e,d as s,b as a,t as r}from"./index-DgiuPnKP.js";import{r as l}from"./vendor-DaJCiAzA.js";import{X as t,n as o,f as i,d,P as n,M as c,Z as m,U as x,g as u,E as p}from"./ui-CTO2A6V9.js";import{C as g}from"./Layout-B3msiOoc.js";import"./router-C-K4H33B.js";import"./Header-CwMlxLm9.js";const b=({onClose:s,onSubmit:a})=>{const[r,o]=l.useState({name:"",code:"",description:"",color:"#3B82F6",keywords:""}),[i,d]=l.useState(!1),n=e=>{const{name:s,value:a}=e.target;o(e=>({...e,[s]:a}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Novo Departamento"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(t,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),d(!0);try{const e={...r,keywords:r.keywords.split(",").map(e=>e.trim()).filter(e=>e)};await a(e)}finally{d(!1)}},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Departamento *"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:n,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: Açougue"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Código *"}),e.jsx("input",{type:"text",name:"code",value:r.code,onChange:n,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: ACG",maxLength:10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:r.description,onChange:n,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descrição do departamento..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor do Departamento"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",name:"color",value:r.color,onChange:n,className:"w-12 h-10 border border-gray-300 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:r.color,onChange:e=>o(s=>({...s,color:e.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"#3B82F6"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Palavras-chave para Categorização Automática"}),e.jsx("input",{type:"text",name:"keywords",value:r.keywords,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: carne, frango, peixe (separadas por vírgula)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Produtos com essas palavras no nome serão automaticamente categorizados neste departamento"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:i,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:i?"Criando...":"Criar Departamento"})]})]})]})})},h=({department:s,onClose:a,onSubmit:r})=>{const[o,i]=l.useState({name:"",code:"",description:"",color:"#3B82F6",keywords:""}),[d,n]=l.useState(!1);l.useEffect(()=>{if(s){const e=s.keywords?s.keywords.join(", "):"";i({name:s.name||"",code:s.code||"",description:s.description||"",color:s.color||"#3B82F6",keywords:e})}},[s]);const c=e=>{const{name:s,value:a}=e.target;i(e=>({...e,[s]:a}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Editar Departamento"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(t,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{const e=o.keywords.split(",").map(e=>e.trim()).filter(e=>e),s={...o,keywords:e};await r(s)}finally{n(!1)}},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Departamento *"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: Açougue"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Código *"}),e.jsx("input",{type:"text",name:"code",value:o.code,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: ACG",maxLength:10})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:o.description,onChange:c,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descrição do departamento..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor do Departamento"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"color",name:"color",value:o.color,onChange:c,className:"w-12 h-10 border border-gray-300 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:o.color,onChange:e=>i(s=>({...s,color:e.target.value})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"#3B82F6"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Palavras-chave para Categorização Automática"}),e.jsx("input",{type:"text",name:"keywords",value:o.keywords,onChange:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: carne, frango, peixe (separadas por vírgula)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Produtos com essas palavras no nome serão automaticamente categorizados neste departamento"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:d?"Salvando...":"Salvar Alterações"})]})]})]})})},y=({department:s,onClose:a,onSubmit:r})=>{const[o,i]=l.useState({name:"",description:"",display_order:1,polling_interval:30,active:!0,is_default:!1}),[d,n]=l.useState(!1),c=e=>{const{name:s,value:a,type:r}=e.target;if("checkbox"===r){const a=e.target.checked;i(e=>({...e,[s]:a}))}else i("number"===r?e=>({...e,[s]:parseInt(a)||0}):e=>({...e,[s]:a}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Novo Painel - ",s.name]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(t,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{await r(o)}finally{n(!1)}},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Painel *"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: Carnes Premium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:o.description,onChange:c,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descrição do painel..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ordem de Exibição"}),e.jsx("input",{type:"number",name:"display_order",value:o.display_order,onChange:c,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intervalo (segundos)"}),e.jsx("input",{type:"number",name:"polling_interval",value:o.polling_interval,onChange:c,min:"10",max:"300",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"active",id:"active",checked:o.active,onChange:c,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-700",children:"Painel ativo"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_default",id:"is_default",checked:o.is_default,onChange:c,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_default",className:"ml-2 block text-sm text-gray-700",children:"Painel padrão do departamento"})]})]}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Dica:"})," O painel padrão será usado para produtos que não foram associados especificamente a outros painéis do departamento."]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:d?"Criando...":"Criar Painel"})]})]})]})})},j=({panel:s,onClose:a,onSubmit:r})=>{const[o,i]=l.useState({name:"",description:"",display_order:1,polling_interval:30,active:!0,is_default:!1}),[d,n]=l.useState(!1);l.useEffect(()=>{s&&i({name:s.name||"",description:s.description||"",display_order:s.display_order||1,polling_interval:s.polling_interval||30,active:s.active??!0,is_default:s.is_default??!1})},[s]);const c=e=>{const{name:s,value:a,type:r}=e.target;if("checkbox"===r){const a=e.target.checked;i(e=>({...e,[s]:a}))}else i("number"===r?e=>({...e,[s]:parseInt(a)||0}):e=>({...e,[s]:a}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Editar Painel"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(t,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:async e=>{e.preventDefault(),n(!0);try{await r(o)}finally{n(!1)}},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Painel *"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:c,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Ex: Carnes Premium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição"}),e.jsx("textarea",{name:"description",value:o.description,onChange:c,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Descrição do painel..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ordem de Exibição"}),e.jsx("input",{type:"number",name:"display_order",value:o.display_order,onChange:c,min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intervalo (segundos)"}),e.jsx("input",{type:"number",name:"polling_interval",value:o.polling_interval,onChange:c,min:"10",max:"300",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"active",id:"active",checked:o.active,onChange:c,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-700",children:"Painel ativo"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_default",id:"is_default",checked:o.is_default,onChange:c,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"is_default",className:"ml-2 block text-sm text-gray-700",children:"Painel padrão do departamento"})]})]}),e.jsx("div",{className:"bg-blue-50 p-3 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Dica:"})," O painel padrão será usado para produtos que não foram associados especificamente a outros painéis do departamento."]})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:d?"Salvando...":"Salvar Alterações"})]})]})]})})},f=({panel:c,onClose:m,onUpdate:x})=>{const[u,p]=l.useState([]),[g,b]=l.useState([]),[h,y]=l.useState(""),[j,f]=l.useState(!0),[v,N]=l.useState(!1),[w,C]=l.useState(null);l.useEffect(()=>{k()},[c.id]);const k=async()=>{try{f(!0);const[e,r]=await Promise.all([s.getPanelProducts(c.id),a.getProducts()]);p(e);const l=e.map(e=>e.id),t=r.filter(e=>!l.includes(e.id));b(t)}catch(e){r.error("Erro ao carregar produtos do painel")}finally{f(!1)}},P=g.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())||e.codigo.toLowerCase().includes(h.toLowerCase()));return j?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 h-96 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl mx-4 max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Gerenciar Produtos - ",c.name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[u.length," produtos no painel"]})]}),e.jsx("button",{onClick:m,className:"text-gray-400 hover:text-gray-600",children:e.jsx(t,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 h-full",children:[e.jsxs("div",{className:"border-r border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["Produtos no Painel (",u.length,")"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0===u.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum produto no painel"})]}):e.jsx("div",{className:"space-y-2",children:u.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Código: ",a.codigo]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Preço: R$ ",a.price.toFixed(2)]}),e.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Posição"}),e.jsx("input",{type:"number",min:1,max:24,defaultValue:a.position_override||a.position||1,onBlur:e=>{const l=parseInt(e.target.value||"0",10)||0;l>=1&&l<=24?(async(e,a)=>{var l,t;try{C(e.id),await s.updateProductInPanel(c.id,e.id,{position_override:a}),r.success("Posição atualizada"),k(),x()}catch(o){r.error((null==(t=null==(l=o.response)?void 0:l.data)?void 0:t.error)||"Erro ao atualizar posição")}finally{C(null)}})(a,l):r.error("Posição deve ser entre 1 e 24")},className:"w-20 px-2 py-1 border border-gray-300 rounded"})]}),e.jsx("button",{onClick:()=>(async e=>{var a,l;try{C(e.id),await s.updateProductInPanel(c.id,e.id,{active_in_panel:!e.active_in_panel}),r.success("Visibilidade atualizada"),k(),x()}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao atualizar visibilidade")}finally{C(null)}})(a),disabled:w===a.id,className:"px-2 py-1 text-xs rounded "+(a.active_in_panel?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),title:a.active_in_panel?"Visível no painel":"Oculto no painel",children:a.active_in_panel?"Visível":"Oculto"})]})]}),e.jsx("button",{onClick:()=>(async e=>{var a,l;if(confirm("Tem certeza que deseja remover este produto do painel?"))try{await s.removeProductFromPanel(c.id,e),r.success("Produto removido do painel!"),k(),x()}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao remover produto")}})(a.id),className:"p-2 text-red-600 hover:bg-red-50 rounded",title:"Remover do painel",children:e.jsx(i,{className:"h-4 w-4"})})]},a.id))})})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:["Produtos Disponíveis (",g.length,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Buscar produtos...",value:h,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:0===P.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:h?"Nenhum produto encontrado":"Todos os produtos já estão no painel"})]}):e.jsx("div",{className:"space-y-2",children:P.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Código: ",a.codigo]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Preço: R$ ",a.price.toFixed(2)]}),e.jsx("span",{className:"inline-block px-2 py-1 text-xs rounded "+(a.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.is_active?"Ativo":"Inativo"})]}),e.jsx("button",{onClick:()=>(async e=>{var a,l;try{await s.addProductToPanel(c.id,e),r.success("Produto adicionado ao painel!"),k(),x()}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao adicionar produto")}})(a.id),disabled:v,className:"p-2 text-blue-600 hover:bg-blue-50 rounded disabled:opacity-50",title:"Adicionar ao painel",children:e.jsx(n,{className:"h-4 w-4"})})]},a.id))})})]})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:m,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Fechar"})})})]})})},v=()=>{const[a,t]=l.useState([]),[d,v]=l.useState(null),[N,w]=l.useState([]),[C,k]=l.useState(!0),[P,_]=l.useState(!1),[S,D]=l.useState(!1),[E,z]=l.useState(!1),[A,F]=l.useState(!1),[q,I]=l.useState(!1),[$,B]=l.useState(!1),[L,O]=l.useState(null),[T,G]=l.useState(null),[V,R]=l.useState(null);l.useEffect(()=>{U()},[]),l.useEffect(()=>{d&&H(d.id)},[d]);const U=async()=>{try{k(!0);const e=await s.getDepartments();t(e),e&&e.length>0&&!d&&v(e[0])}catch(e){r.error("Erro ao carregar departamentos")}finally{k(!1)}},H=async e=>{try{_(!0);const a=await s.getDepartmentPanels(e);w(a)}catch(a){r.error("Erro ao carregar painéis do departamento")}finally{_(!1)}};return C?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs(g,{animation:"fade",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gestão de Departamentos"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerencie departamentos e seus painéis segmentados"})]}),e.jsxs("button",{onClick:()=>D(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),"Novo Departamento"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(o,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Departamentos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(null==a?void 0:a.length)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(c,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Painéis"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(null==a?void 0:a.reduce((e,s)=>e+(s.panels_count||0),0))||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(m,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Painéis Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(null==N?void 0:N.filter(e=>e.active).length)||0})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(x,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Departamento Selecionado"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:d?d.name:"Nenhum"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Departamentos"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:a.map(l=>e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 "+((null==d?void 0:d.id)===l.id?"bg-blue-50 border-r-4 border-blue-600":""),onClick:()=>v(l),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:l.color}}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:l.name}),e.jsx("p",{className:"text-sm text-gray-500",children:l.code})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:[l.panels_count," painéis"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:e=>{e.stopPropagation(),(e=>{O(e),z(!0)})(l)},className:"p-1 text-gray-400 hover:text-blue-600",children:e.jsx(u,{className:"h-4 w-4"})}),e.jsx("button",{onClick:e=>{e.stopPropagation(),(async e=>{var l,t;if(confirm(`Tem certeza que deseja excluir o departamento "${e.name}"?`))try{if(await s.deleteDepartment(e.id),r.success("Departamento excluído com sucesso!"),(null==d?void 0:d.id)===e.id){const s=a.filter(s=>s.id!==e.id);v(s.length>0?s[0]:null)}U()}catch(o){r.error((null==(t=null==(l=o.response)?void 0:l.data)?void 0:t.error)||"Erro ao excluir departamento")}})(l)},className:"p-1 text-gray-400 hover:text-red-600",children:e.jsx(i,{className:"h-4 w-4"})})]})]})]})},l.id))})]})}),e.jsx("div",{className:"lg:col-span-2",children:d?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:d.color}}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Painéis - ",d.name]}),e.jsx("p",{className:"text-sm text-gray-500",children:d.description})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:async()=>{var e,a;if(d)try{const e=await s.autoCategorizeProducts(d.id);r.success(`${e.categorized_count} produtos categorizados automaticamente para ${e.department}`),H(d.id)}catch(l){r.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.error)||"Erro na categorização automática")}},className:"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2 text-sm",children:[e.jsx(m,{className:"h-4 w-4"}),"Auto Categorizar"]}),e.jsxs("button",{onClick:()=>F(!0),className:"bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 text-sm",children:[e.jsx(n,{className:"h-4 w-4"}),"Novo Painel"]})]})]})}),e.jsx("div",{className:"p-4",children:P?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}):0===N.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum painel encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Este departamento ainda não possui painéis configurados."}),e.jsxs("button",{onClick:()=>F(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 mx-auto",children:[e.jsx(n,{className:"h-4 w-4"}),"Criar Primeiro Painel"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:N.map(a=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-medium text-gray-900 flex items-center gap-2",children:[a.name,a.is_default&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:"Padrão"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>(e=>{if(!d)return;const s=`/departments/${d.id}/panels/${e.id}/view`;window.open(s,"_blank")})(a),className:"p-1 text-gray-400 hover:text-green-600",title:"Visualizar Painel",children:e.jsx(p,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>(e=>{R(e),B(!0)})(a),className:"p-1 text-gray-400 hover:text-blue-600",title:"Gerenciar Produtos",children:e.jsx(x,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>(e=>{G(e),I(!0)})(a),className:"p-1 text-gray-400 hover:text-blue-600",title:"Editar Painel",children:e.jsx(u,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>(async e=>{var a,l;if(confirm(`Tem certeza que deseja excluir o painel "${e.name}"?`))try{await s.deleteDepartmentPanel(e.id),r.success("Painel excluído com sucesso!"),d&&H(d.id)}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao excluir painel")}})(a),className:"p-1 text-gray-400 hover:text-red-600",title:"Excluir Painel",children:e.jsx(i,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[a.products_count," produtos"]}),e.jsxs("span",{children:["Ordem: ",a.display_order]})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["Intervalo: ",a.polling_interval,"s"]}),e.jsx("span",{className:"px-2 py-1 rounded "+(a.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:a.active?"Ativo":"Inativo"})]})]},a.id))})})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8 text-center",children:[e.jsx(o,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Selecione um departamento"}),e.jsx("p",{className:"text-gray-600",children:"Escolha um departamento na lista ao lado para visualizar seus painéis"})]})})]})]}),S&&e.jsx(b,{onClose:()=>D(!1),onSubmit:async e=>{var a,l;try{await s.createDepartment(e),r.success("Departamento criado com sucesso!"),D(!1),U()}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao criar departamento")}}}),E&&L&&e.jsx(h,{department:L,onClose:()=>{z(!1),O(null)},onSubmit:async e=>{var a,l;if(L)try{await s.updateDepartment(L.id,e),r.success("Departamento atualizado com sucesso!"),z(!1),O(null),U()}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao atualizar departamento")}}}),A&&d&&e.jsx(y,{department:d,onClose:()=>F(!1),onSubmit:async e=>{var a,l;if(d)try{await s.createDepartmentPanel(d.id,e),r.success("Painel criado com sucesso!"),F(!1),H(d.id)}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao criar painel")}}}),q&&T&&e.jsx(j,{panel:T,onClose:()=>{I(!1),G(null)},onSubmit:async e=>{var a,l;if(T)try{await s.updateDepartmentPanel(T.id,e),r.success("Painel atualizado com sucesso!"),I(!1),G(null),d&&H(d.id)}catch(t){r.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||"Erro ao atualizar painel")}}}),$&&V&&e.jsx(f,{panel:V,onClose:()=>{B(!1),R(null)},onUpdate:()=>{d&&H(d.id)}})]})};export{v as default};
