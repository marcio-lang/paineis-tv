import{p as e,t as a,j as s,B as l,I as t}from"./index-DgiuPnKP.js";import{r}from"./vendor-DaJCiAzA.js";import{T as i,M as n}from"./Modal-C5T-U6VA.js";import{C as d}from"./Layout-B3msiOoc.js";import{P as o,E as c,c as m,V as u,d as x,e as h,f as p,g}from"./ui-CTO2A6V9.js";import"./router-C-K4H33B.js";import"./Header-CwMlxLm9.js";const y=()=>{const[y,j]=r.useState([]),[v,f]=r.useState([]),[N,b]=r.useState(!0),[w,_]=r.useState(""),[C,P]=r.useState(!1),[k,E]=r.useState(!1),[L,M]=r.useState(!1),[S,z]=r.useState(null),[D,I]=r.useState({name:"",layout_type:"layout_1"}),[T,q]=r.useState({}),[G,B]=r.useState([]),[O,V]=r.useState(!1),A=r.useCallback(async()=>{try{b(!0);const a=await e.getPanels();a&&a.length,j(a),f(a)}catch(s){a.error("Erro ao carregar painéis")}finally{b(!1)}},[]);r.useEffect(()=>{A()},[A]),r.useEffect(()=>{if(w){const e=(y||[]).filter(e=>e.name.toLowerCase().includes(w.toLowerCase())||e.fixed_url.toLowerCase().includes(w.toLowerCase()));f(e)}else f(y||[])},[y,w]);const $=async s=>{try{const a=await e.getPanelMedia(s);B(a)}catch(l){a.error("Erro ao carregar mídia do painel")}};r.useEffect(()=>{A()},[]);const F=[{key:"name",title:"Nome",render:e=>s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:e.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["URL: ",e.fixed_url]})]})},{key:"layout_type",title:"Layout",render:e=>s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:{layout_1:"1 Imagem",layout_2:"2 Imagens",layout_3:"3 Imagens",layout_4:"4 Imagens"}[e.layout_type]})},{key:"created_at",title:"Criado em",render:e=>{if(!e.created_at)return"Data não disponível";const a=new Date(e.created_at);return isNaN(a.getTime())?"Data inválida":a.toLocaleDateString("pt-BR")}},{key:"actions",title:"Ações",render:t=>s.jsxs("div",{className:"flex space-x-2",children:[s.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(e=>{const a=`/p/${e.fixed_url}`;window.open(a,"_blank")})(t),className:"text-green-600 hover:text-green-700",children:s.jsx(c,{className:"h-4 w-4"})}),s.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(e=>{z(e),M(!0),$(e.id)})(t),className:"text-blue-600 hover:text-blue-700",children:s.jsx(h,{className:"h-4 w-4"})}),s.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(e=>{e?e.name&&e.layout_type?(z(e),q({name:e.name,layout_type:e.layout_type}),E(!0)):a.error("Erro: Dados do painel incompletos"):a.error("Erro: Dados do painel não encontrados")})(t),className:"text-yellow-600 hover:text-yellow-700",children:s.jsx(g,{className:"h-4 w-4"})}),s.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(async s=>{var l,t;if(confirm(`Tem certeza que deseja deletar o painel "${s.name}"?`))try{await e.deletePanel(s.id),a.success("Painel deletado com sucesso!"),A()}catch(r){a.error((null==(t=null==(l=r.response)?void 0:l.data)?void 0:t.error)||"Erro ao deletar painel")}})(t),className:"text-red-600 hover:text-red-700",children:s.jsx(p,{className:"h-4 w-4"})})]})}],J=[{value:"layout_1",label:"Layout 1 - Imagem/Video"},{value:"layout_2",label:"Layout 2 - Lista Vertical"},{value:"layout_3",label:"Layout 3 - Carrossel"}];return s.jsx(d,{animation:"fade",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gerenciar Painéis"}),s.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Gerencie os painéis de TV do sistema"})]}),s.jsxs(l,{onClick:()=>P(!0),children:[s.jsx(o,{className:"h-4 w-4 mr-2"}),"Novo Painel"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(c,{className:"h-6 w-6 text-blue-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Painéis"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(null==y?void 0:y.length)||0})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(m,{className:"h-6 w-6 text-green-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"1 Imagem"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(y||[]).filter(e=>"layout_1"===e.layout_type).length})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:s.jsx(u,{className:"h-6 w-6 text-yellow-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"2 Imagens"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(y||[]).filter(e=>"layout_2"===e.layout_type).length})]})]})}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(o,{className:"h-6 w-6 text-purple-600"})}),s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Outros Layouts"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(y||[]).filter(e=>!["layout_1","layout_2"].includes(e.layout_type)).length})]})]})})]}),s.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:s.jsxs("div",{className:"relative",children:[s.jsx(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),s.jsx("input",{type:"text",placeholder:"Buscar painéis...",value:w,onChange:e=>_(e.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow",children:s.jsx(i,{data:v,columns:F,loading:N,emptyMessage:"Nenhum painel encontrado"})}),s.jsx(n,{isOpen:C,onClose:()=>P(!1),title:"Criar Novo Painel",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(t,{label:"Nome do Painel",value:D.name,onChange:e=>I({...D,name:e.target.value}),placeholder:"Digite o nome do painel"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Layout"}),s.jsx("select",{value:D.layout_type,onChange:e=>I({...D,layout_type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:J&&J.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(l,{variant:"outline",onClick:()=>P(!1),children:"Cancelar"}),s.jsx(l,{onClick:async()=>{var s,l;const t=e.validatePanelData(D);if(t.length>0)t.forEach(e=>a.error(e));else try{await e.createPanel(D),a.success("Painel criado com sucesso!"),P(!1),I({name:"",layout_type:"layout_1"}),A()}catch(r){a.error((null==(l=null==(s=r.response)?void 0:s.data)?void 0:l.error)||"Erro ao criar painel")}},children:"Criar Painel"})]})]})}),s.jsx(n,{isOpen:k,onClose:()=>E(!1),title:"Editar Painel",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx(t,{label:"Nome do Painel",value:T.name||"",onChange:e=>q({...T,name:e.target.value}),placeholder:"Digite o nome do painel"}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Layout"}),s.jsx("select",{value:T.layout_type||"layout_1",onChange:e=>q({...T,layout_type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:J&&J.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]}),s.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s.jsx(l,{variant:"outline",onClick:()=>E(!1),children:"Cancelar"}),s.jsx(l,{onClick:async()=>{var s,l;if(!S)return;const t=e.validatePanelData(T);if(t.length>0)t.forEach(e=>a.error(e));else try{await e.updatePanel(S.id,T),a.success("Painel atualizado com sucesso!"),E(!1),z(null),q({}),A()}catch(r){a.error((null==(l=null==(s=r.response)?void 0:s.data)?void 0:l.error)||"Erro ao atualizar painel")}},children:"Salvar Alterações"})]})]})}),s.jsx(n,{isOpen:L,onClose:()=>M(!1),title:`Mídia do Painel: ${null==S?void 0:S.name}`,size:"lg",children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(h,{className:"mx-auto h-12 w-12 text-gray-400"}),s.jsxs("div",{className:"mt-4",children:[s.jsxs("label",{htmlFor:"media-upload",className:"cursor-pointer",children:[s.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:"Clique para enviar mídia"}),s.jsx("span",{className:"mt-1 block text-sm text-gray-500",children:"PNG, JPG, JPEG ou MP4 até 100MB"})]}),s.jsx("input",{id:"media-upload",type:"file",className:"hidden",accept:"image/*,video/mp4",onChange:async s=>{var l,t,r;if(!S||!(null==(l=s.target.files)?void 0:l[0]))return;const i=s.target.files[0],n=e.validateMediaFile(i);if(n.length>0)n.forEach(e=>a.error(e));else try{V(!0),await e.uploadPanelMedia(S.id,i),a.success("Mídia enviada com sucesso!"),$(S.id)}catch(d){a.error((null==(r=null==(t=d.response)?void 0:t.data)?void 0:r.error)||"Erro ao enviar mídia")}finally{V(!1)}},disabled:O})]}),O&&s.jsx("div",{className:"mt-4",children:s.jsx("div",{className:"text-sm text-blue-600",children:"Enviando..."})})]})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Arquivos de Mídia (",(null==G?void 0:G.length)||0,")"]}),0===((null==G?void 0:G.length)||0)?s.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhuma mídia encontrada"}):s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:G.map(t=>s.jsxs("div",{className:"relative group",children:[s.jsx("div",{className:"aspect-square bg-gray-100 rounded-lg overflow-hidden",children:"image"===t.file_type?s.jsx("img",{src:e.getMediaUrl(t.filename),alt:t.original_filename,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(u,{className:"h-12 w-12 text-gray-400"})})}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center",children:s.jsx(l,{variant:"ghost",size:"sm",onClick:()=>(async s=>{var l,t;if(S&&confirm("Tem certeza que deseja deletar esta mídia?"))try{await e.deletePanelMedia(S.id,s),a.success("Mídia deletada com sucesso!"),$(S.id)}catch(r){a.error((null==(t=null==(l=r.response)?void 0:l.data)?void 0:t.error)||"Erro ao deletar mídia")}})(t.id),className:"text-white hover:text-red-300",children:s.jsx(p,{className:"h-4 w-4"})})}),s.jsx("p",{className:"mt-2 text-xs text-gray-600 truncate",children:t.original_filename})]},t.id))})]})]})})]})})};function j(){return s.jsx(y,{})}export{j as default};
